<% # app/views/users/index.html.erb %>

<h1><%= t('profile') %></h1>
<% @users.each do |user| %>
  <div class="row justify-content-between user-block">
    <div class='col-sm-auto'>
      <div class="form-group">
        <label><%= t('name')+':' %></label>
        <label>
          <% begin %>
            <%= '@'+user.name.downcase %>
          <% rescue %>
            <%= '@'+'user_name_error' %>
          <% end %>
        </label>
      </div>

      <div class="form-group">
        <label>Email:</label>
        <label>
          <% begin %>
            <%= user.email.downcase %>
          <% rescue %>
            <%= 'user_email_error' %>
          <% end %>
        </label>
      </div>
      
      <div class="form-group">
        <label>
          <%= t("user's posts")+':' %>
        </label>
        <% Post.where(user_id: user.id).each do |post| %>
          <a class="h3" href=<%= "/posts/show?id=#{post.id.to_s}"%>>
            <%= post.title %>
          </a>
        <% end %>
      </div>
    </div>

    <% if (user.id == current_user.id) %>
      <div class='col-sm-auto row align-items-center'>
        <div class='col-sm-auto' style='padding-left: 0'>
          <%= link_to t("edit"), users_edit_path(id: user.id, user_id: current_user.id), class: "btn btn-info" %>
        </div>

        <div class='col-sm-auto' style='padding-left: 0'>
          <%= button_to t("delete"), posts_remove_path(id: user.id, user_id: current_user.id), method: :delete, data: {confirm: 'Are you sure?'}, class: "btn btn-danger" %>
        </div>
      </div>
    <% end %>
  </div>
<% end %>